@page "/User/Houses"
@inject IHouseService HouseService
@inject NavigationManager NavigationManager
@attribute [Authorize(Roles = "Customer")]


@if (HouseService.UserHouses == null)
{
    <Loading />
}
else
{
    <button class="btn btn-primary float-end mt-10" @onclick="CreateHouse">
        <i class="oi oi-plus"></i>Add new house
    </button>
    <table class="table">
        <thead>
            <tr>
                <th></th>
                <th>Title</th>
                <th>Description</th>
                <th>Price</th>

                <th></th>
            </tr>
        </thead>
        <tbody>
            <Virtualize Items="HouseService.UserHouses" Context="house">
                <tr>

                    <td>
                        <img src="images/pilars.jpg" style="max-height:100px;max-width:100px;" />

                    </td>
                    <td>@house.HouseTitle</td>
                    <td>@house.HouseDescription</td>
                    <td>@house.HouseFeature.Price</td>
                    <td>
                        <button class="btn btn-primary" @onclick="(()=>EditHouse(house.Id))">
                            <i class="oi oi-pencil"></i>
                        </button>
                    </td>
                </tr>
            </Virtualize>
        </tbody>
    </table>
}




@code {
    protected override async Task OnInitializedAsync()
    {
        await HouseService.GetUserHouses();
    }
    void EditHouse(int houseId)
    {
        NavigationManager.NavigateTo($"User/House/{houseId}");

    }
    void CreateHouse()
    {
        NavigationManager.NavigateTo("User/House");
    }
}
